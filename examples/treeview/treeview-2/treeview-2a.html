<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <title>Navigation Treeview Example Using Computed Properties | WAI-ARIA Authoring Practices 1.1</title>

    <link href="../../css/core.css" rel="stylesheet">
    <link href="../../css/table.css" rel="stylesheet">
    <script src="../../js/examples.js" type="text/javascript"></script>

    <link href="css/treeLinks.css" rel="stylesheet">
    <script type="text/javascript" src="js/treeLinks.js"></script>
    <script type="text/javascript" src="js/treeitemLinks.js"></script>
    <script type="text/javascript" src="js/treeitemClick.js"></script>
  </head>
  <body>
    <main>
      <h1>Navigation Treeview Example Using Computed Properties</h1>
      <p>
        Code is complete for this example. 
        Feedback and progress on editorial work on this page are being tracked in 
        <a href="https://github.com/w3c/aria-practices/issues/225">issue 225.</a>
      </p>
  <p>
    The below example demonstrates how the  
    <a href="../../../#TreeView">Treeview Design Pattern</a>
    can be used to build a navigation tree for a set of hierarchically organized web pages.
    In this example, the user can browse a set of pages about foods that is organized into categories.
    Activating an item in the tree will open a page about the chosen food.
  </p>
  <p>
    Since a tree item is the only kind of interactive element that can be contained in a tree, links to web pages in a navigation tree have the <code>treeitem</code> role.
  </p>
  <p>
        This example relies on the browser to compute values for <code>aria-setsize</code>, <code>aria-posinset</code>, and <code>aria-level</code>.   
        The ARIA 1.0 specification for these properties states that browsers can, but are not required to, compute their values. 
        So, some browser and assistive technology combinations may not compute or report correct position and level information if it is not explicitly declared.
        If testing reveals gaps in support for these properties, override automatic computation by explicitly declaring their values as demonstrated in the example of a 
        <a href="../treeview-2/treeview-2b.html">Navigation Treeview using <em>declared</em> properties.</a>
       </p>
      <p>Similar examples include: </p>
      <ul>
        <li><a href="../treeview-1/treeview-1a.html">File Directory Treeview using <em>computed</em> properties</a></li>
        <li><a href="../treeview-1/treeview-1b.html">File Directory Treeview using <em>declared</em> properties</a></li>
        <li><a href="../treeview-2/treeview-2b.html">Navigation Treeview using <em>declared</em> properties</a></li>
      </ul>
  <section>
        <h2 id="ex_label">Example</h2>
        <div role="separator" id="ex_start_sep" aria-labelledby="ex_start_sep ex_label" aria-label="Start of"></div>
        <div id="ex1">
          <h3 id="tree1">Foods</h3>
          <ul role="tree" aria-labelledby="tree1" >
            <li role="treeitem"
                aria-expanded="false"
                aria-label="Fruits">
              <span>Fruits</span>
              <ul>
                <li role="none">
                  <a role="treeitem"
                     href="https://en.wikipedia.org/wiki/Orange_%28fruit%29">
                      Oranges
                  </a>
                </li>
                <li role="none">
                  <a role="treeitem"
                     href="https://en.wikipedia.org/wiki/Pineapple">
                      Pineapple
                  </a>
                </li>
                <li role="treeitem"
                    aria-expanded="false"
                    aria-label="Apples">
                    <span>Apples</span>
                  <ul role="group">
                    <li role="none">
                      <a role="treeitem"
                         href="https://en.wikipedia.org/wiki/McIntosh_%28apple%29">
                          Macintosh
                      </a>
                    </li>
                    <li role="none">
                      <a role="treeitem"
                         href="https://en.wikipedia.org/wiki/Granny_Smith">
                          Granny Smith
                      </a>
                    </li>
                    <li role="none">
                      <a role="treeitem"
                         href="https://en.wikipedia.org/wiki/Fuji_(apple)">
                          Fuji
                      </a>
                    </li>
                  </ul>
                </li>
                <li role="none">
                  <a role="treeitem"
                     href="https://en.wikipedia.org/wiki/Banana">
                      Bananas
                  </a>
                </li>
                <li role="treeitem"
                    aria-expanded="false"
                    aria-label="Pears">
                  <span> Pears </span>
                  <ul role="group">
                    <li>
                      <a role="treeitem"
                         href="https://en.wikipedia.org/wiki/D%27Anjou">
                          Anjou
                      </a>
                    </li>
                    <li role="none">
                      <a role="treeitem"
                         href="https://en.wikipedia.org/wiki/Williams_pear">
                          Bartlett
                      </a>
                    </li>
                    <li role="none">
                      <a role="treeitem"
                         href="https://en.wikipedia.org/wiki/Bosc_pear">
                          Bosc
                      </a>
                    </li>
                    <li role="none">
                      <a role="treeitem"
                         href="https://en.wikipedia.org/wiki/Pyrus_communis">
                          Concorde
                      </a>
                    </li>
                    <li role="none">
                      <a role="treeitem"
                         href="https://en.wikipedia.org/wiki/Pyrus_communis">
                          Seckel
                      </a>
                    </li>
                    <li role="none">
                      <a role="treeitem"
                         href="https://en.wikipedia.org/wiki/Pyrus_communis">
                          Starkrimson
                      </a>
                    </li>
                  </ul>
                </li>
              </ul>
            </li>
            <li role="treeitem"
                aria-expanded="false"
                aria-label="Vegetables">
              <span>Vegetables</span>
              <ul role="group">
                <li role="treeitem"
                    aria-expanded="false"
                    aria-label="Podded Vegetables">
                  <span>Podded Vegetables</span>
                  <ul role="group">
                    <li role="none">
                        <a role="treeitem"
                           href="https://en.wikipedia.org/wiki/Lentil">
                            Lentil
                        </a>
                    </li>
                    <li role="none">
                        <a role="treeitem"
                           href="https://en.wikipedia.org/wiki/Pea">
                            Pea
                        </a>
                    </li>
                    <li role="none">
                        <a role="treeitem"
                           href="https://en.wikipedia.org/wiki/Peanut">
                            Peanut
                        </a>
                    </li>
                  </ul>
                </li>
                <li role="treeitem"
                    aria-expanded="false"
                    aria-label="Bulb and Stem Vegetables">
                  <span>Bulb and Stem Vegetables</span>
                  <ul role="group">
                    <li role="none">
                      <a role="treeitem"
                         href="https://en.wikipedia.org/wiki/Asparagus">
                          Asparagus
                      </a>
                    </li>
                    <li role="none">
                        <a role="treeitem"
                           href="https://en.wikipedia.org/wiki/Celery">
                            Celery
                        </a>
                    </li>
                    <li role="none">
                        <a role="treeitem"
                           href="https://en.wikipedia.org/wiki/Leek">
                            Leek
                        </a>
                    </li>
                    <li role="none">
                        <a role="treeitem"
                           href="https://en.wikipedia.org/wiki/Onion">
                            Onion
                        </a>
                    </li>
                  </ul>
                </li>
                <li role="treeitem"
                    aria-expanded="false"
                    aria-label="Root and Tuberous Vegetables">
                  <span>Root and Tuberous Vegetables</span>
                  <ul role="group">
                    <li role="none">
                        <a role="treeitem"
                           href="https://en.wikipedia.org/wiki/Carrot">
                            Carrot
                        </a>
                    </li>
                    <li role="none">
                        <a role="treeitem"
                           href="https://en.wikipedia.org/wiki/Ginger">
                            Ginger
                        </a>
                    </li>
                    <li role="none">
                      <a role="treeitem"
                         href="https://en.wikipedia.org/wiki/Parsnip">
                          Parsnip
                      </a>
                    </li>
                    <li role="none">
                      <a role="treeitem"
                         href="https://en.wikipedia.org/wiki/Potato">
                          Potato
                      </a>
                    </li>
                  </ul>
                </li>
              </ul>
            </li>
            <li role="treeitem"
                aria-expanded="false"
                aria-label=" Grains">
              <span>Grains</span>
              <ul role="group">
                <li role="treeitem"
                    aria-expanded="false"
                    aria-label="Cereal grains">
                  <span>Cereal Grains</span>
                  <ul role="group">
                    <li role="none">
                      <a role="treeitem"
                         href="https://en.wikipedia.org/wiki/Barley">
                          Barley
                      </a>
                    </li>
                    <li role="none">
                      <a role="treeitem"
                         href="https://en.wikipedia.org/wiki/Oats">
                          Oats
                      </a>
                    </li>
                    <li role="none">
                      <a role="treeitem"
                         href="https://en.wikipedia.org/wiki/Rice">
                          Rice
                      </a>
                    </li>
                  </ul>
                </li>
                <li role="treeitem"
                    aria-expanded="false"
                    aria-label="Pseudocereal grains">
                  <span>Pseudocereal Grains</span>
                  <ul role="group">
                    <li role="none">
                      <a role="treeitem"
                         href="https://en.wikipedia.org/wiki/Amaranth">
                          Amaranth
                      </a>
                    </li>
                    <li role="none">
                      <a role="treeitem"
                         href="https://en.wikipedia.org/wiki/Buckwheat">
                          Bucketwheat
                      </a>
                    </li>
                    <li role="none">
                      <a role="treeitem"
                         href="https://en.wikipedia.org/wiki/Salvia_hispanica">
                          Chia
                      </a>
                    </li>
                    <li role="none">
                      <a role="treeitem"
                         href="https://en.wikipedia.org/wiki/Quinoa">
                          Quinoa
                      </a>
                    </li>
                  </ul>
                </li>
                <li role="treeitem"
                    aria-expanded="false"
                    aria-label="Oilseeds">
                  <span>Oilseeds</span>
                  <ul role="group">
                    <li role="none">
                      <a role="treeitem"
                         href="https://en.wikipedia.org/wiki/Brassica_juncea">
                          India Mustard
                      </a>
                    </li>
                    <li role="none">
                      <a role="treeitem"
                         href="https://en.wikipedia.org/wiki/Safflower">
                          Safflower
                      </a>
                    </li>
                    <li role="none">
                      <a role="treeitem"
                         href="https://en.wikipedia.org/wiki/Flax_seed">
                          Flax Seed
                      </a>
                    </li>
                    <li role="none">
                      <a role="treeitem"
                         href="https://en.wikipedia.org/wiki/Poppy_seed">
                          Poppy Seed
                      </a>
                    </li>
                  </ul>
                </li>
              </ul>
            </li>
          </ul>
        </div>
        <div role="separator" id="ex_end_sep" aria-labelledby="ex_end_sep ex_label" aria-label="End of"></div>
      </section>

      <section>

        <h2>Accessibility Features</h2>
        <ul>
          <li>Need to use CSS focus and hover classes to create focus and hover styling of the visible label for expandable <code>treeitem</code> widgets.  This requires using focus/blur and mouseover/mouseout events to apply classes to the <code>span</code> element that is used as the visible label for the <code>treeitem</code>.</li>
          <li>This example relies on the browser to computer values for <code>aria-setsize</code>, <code>aria-posinset</code> and <code>arial-level</code>.</li>
          <li>The expandable <code>treeitem</code> widgets cannot behave as links, their only action can be to open and close a leaf in the tree.</li>
        </ul>

      </section>

      <section>
        <h2 id="kbd_label">Keyboard Support</h2>

        <table aria-labelledby="kbd_label">
           <thead>
             <tr>
               <th style="width: 8em">Key</th>
               <th>Function</th>
             </tr>
           </thead>
           <tbody>
             <tr>
               <th><kbd>Up arrow</kbd></th>
               <td>
                  <ul>
                    <li>Moves focus to previous visible sibling <code>treeitem</code> using a depth first algorithm on the visible <code>treeitems</code>. If on first <code>treeitem</code>, focus stays on first <code>treeitem</code>.</li>
                  </ul>
                </td>
             </tr>
             <tr>
               <th><kbd>Down arrow</kbd></th>
               <td>
                  <ul>
                    <li>Moves focus to next visible sibling <code>treeitem</code> using a depth first algorithm on the visible <code>treeitems</code>. If on last <code>treeitem</code>, focus stays on the last <code>treeitem</code>.</li>
                  </ul>
                </td>
             </tr>
             <tr>
               <th><kbd>Left Arrow</kbd></th>
               <td>
                 <ul>
                   <li>For a <code>treeitem</code> that is an end node (e.g. no child <code>treeitem</code>s) or is in the collapsed state (e.g. has <code>[aria-expanded=false]</code>), focus moves to the parent <code>treeitem</code>.
                     If a top level <code>treeitem</code> (e.g. parent is <code>tree</code>), focus stays on current <code>treeitem</code>.
                   </li>
                   <li>For a <code>treeitem</code> that is in the expanded state (e.g. has <code>[aria-expanded=true]</code>) it toogles to the collapsed state.   Focus remains on the current <code>treeitem</code>.</li>
                 </ul>
               </td>
             </tr>
             <tr>
               <th><kbd>Right Arrow</kbd></th>
               <td>
                 <ul>
                   <li>For a <code>treeitem</code> that is an end node (e.g. no child <code>treeitem</code>s) focus stays on current <code>treeitem</code>.</li>
                   <li>For a <code>treeitem</code> that is in the collapsed state (e.g. has <code>[aria-expanded=false]</code>) it toogles to the expanded state and focus moves to the first child <code>treeitem</code>.  If no child, focus stays on current <code>treeitem</code>.</li>
                   <li>For a <code>treeitem</code> is in the expanded state, focus moves to the first child <code>treeitem</code>.
                     If no child, focus stays on current <code>treeitem</code>.
                   </li>
                 </ul>
               </td>
             </tr>
             <tr>
                <th><kbd>Return</kbd></th>
                <td>
                  <ul>
                    <li>Performs the default action (e.g. onclick event) on the current <code>treeitem</code>, in this example updating the "File or Folder Selected" textbox.</li>
                  </ul>
                </td>
             </tr>
             <tr>
               <th><kbd>Space</kbd></th>
               <td>
                  <ul>
                    <li>Performs the default action (e.g. onclick event) on the current <code>treeitem</code>, in this example updating the "File or Folder Selected" textbox.</li>
                  </ul>
                </td>
             </tr>
             <tr>
               <th><kbd>Home</kbd></th>
               <td>
                <ul>
                  <li>Moves focus to first <code>treeitem</code> in the <code>tree</code>.</li>
                </ul>
                </td>
             </tr>
             <tr>
               <th><kbd>End</kbd></th>
               <td>
                <ul>
                  <li>Moves focus to last visible <code>treeitem</code> (e.g. depth first) in the <code>tree</code>.</li>
                </ul>
                </td>
             </tr>
             <tr>
               <th><kbd>a-z, A-Z</kbd></th>
               <td>
                 <ul>
                   <li>Moves focus to next visible <code>treeitem</code> that starts with letter character.</li>
                   <li>Search wraps to first <code>treeitem</code> if not found after current <code>treeitem</code>.</li>
                 </ul>
               </td>
             </tr>
             <tr>
               <th><kbd>*</kbd></th>
               <td>
                <ul>
                  <li>Opens all the expandable <code>treeitem</code>s in the current leaf (e.g. siblings of the current <code>treeitem</code>), keyboard focus does not change.</li>
                </ul>
               </td>
             </tr>
           </tbody>
        </table>
      </section>

      <section>
        <h2 id="rps_label">ARIA Roles, Properties and States</h2>

        <table aria-labelledby="rps_label">
          <thead>
            <tr>
              <th scope="col">Role</th>
              <th scope="col">Attribute</th>
              <th scope="col">Element</th>
              <th scope="col">Usage</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <th scope="row"><code>tree</code></th>
              <td></td>
              <td><code>ul</code></td>
              <td>
                <ul>
                  <li>The <code>role=&quot;tree&quot;</code> attribute identifies the <code>ul</code> element as an ARIA <code>tree</code> widget.</li>
                  <li>Accessible name for the <code>tree</code> widget comes from <code>aria-label</code> attribute.</li>
                  <li>The <code>tree</code> widget does not need a <code>tabindex</code> value, since the <code>ul[role&quot;tree&quot;]</code> element never receives keyboard focus.</li>
                </ul>
              </td>
            </tr>
            <tr>
              <td></td>
              <th scope="row"><code>aria-label=&quot;<em>string</em>&quot;</code></th>
              <td><code>ul</code></td>
              <td>
                 <ul>
                  <li>Defines an accessible name (e.g. label) for the <code>tree</code> widget.</li>
                  <li>The accessible name is important to identify the purpose of the tree in the page and uniquely identify the <code>tree</code> widget from other trees on the same page.</li>
                 </ul>
              </td>
            </tr>
            <tr>
              <th scope="row"><code>group</code></th>
              <td></td>
              <td><code>ul</code></td>
              <td>
                <ul>
                  <li>The <code>role=&quot;group&quot;</code> attribute identifies the <code>ul</code> element as a container of <code>treeitem</code> widgets for a sub-leaf of a tree.</li>
                  <li>The <code>group</code> role is important for the browser to compute <code>aria-level</code>, <code>aria-setsize</code> and <code>aria-posinset</code>.</li>
                  <li>The <code>group</code> is not required to have an accessible name.</li>
                  <li>The <code>group</code> widget does not need a <code>tabindex</code> value, since the <code>ul[role&quot;group&quot;]</code> element never receives keyboard focus.</li>
                </ul>
              </td>
            </tr>
            <tr>
              <th scope="row"><code>treeitem</code></th>
              <td></td>
              <td><code>li</code>, <code>a</code></td>
              <td>
                <ul>
                  <li>The <code>role=&quot;treeitem&quot;</code> attribute identifies the <code>li</code> element as an ARIA <code>tree</code> widget.</li>
                  <li>Accessible name for the <code>treeitem</code> widget comes from child text content of the <code>li</code> element or an <code>aria-label</code> attribute.</li>
                </ul>
              </td>
            </tr>
            <tr>
              <td></td>
              <th scope="row"><code>tabindex=&quot;-1&quot;</code></th>
              <td><code>li</code>, <code>a</code></td>
              <td>
                <ul>
                  <li>Identifies the <code>treeitem</code> as an elememt that can receive keyboard focus, but will <strong>not</strong> be included in the tab order of the page.</li>
                  <li><code>tabindex=&quot;-1&quot;</code> is the default value for a <code>treeitem</code> widget.</li>
                 </ul>
              </td>
            </tr>
            <tr>
              <td></td>
              <th scope="row"><code>tabindex=&quot;0&quot;</code></th>
              <td><code>li</code>, <code>a</code></td>
              <td>
                <ul>
                  <li>Only one <code>treeitem</code> in the same <code>tree</code> has a <code>tabindex=&quot;0&quot;</code>.</li>
                  <li>Identifies the <code>treeitem</code> that last had keyboard focus.</li>
                  <li>The default <code>treeitem</code> with <code>tabindex=&quot;0&quot;</code> is the first <code>treeitem</code> in the <code>tree</code>.</li>
                  <li>See <a href="../../../#kbd_general_within">roving tabindex</a> for more information.</li>
                 </ul>
              </td>
            </tr>
          <tr>
            <td></td>
            <th scope="row"><code>aria-expanded=&quot;false&quot;</code></th>
            <td><code>li</code></td>
            <td>
              <ul>
                <li>Indicates the <code>treeitem</code> descendants of the current <code>treeitem</code>s are <strong>not</strong> visible (e.g. tree sub-leaf is collapsed).</li>
                <li>The visual state of being collapsed is synchronized with <code>aria-expanded</code> value using CSS attribute selector [<code>aria-expanded=&quot;false&quot;]</code> with the CSS <code>:before</code> psuedo selector and the CSS <code>content</code> property for displaying an image of the collapsed state.</li>
              </ul>
            </td>
          </tr>
          <tr>
            <td></td>
            <th scope="row"><code>aria-expanded=&quot;true&quot;</code></th>
            <td><code>li</code></td>
            <td>
              <ul>
                <li>Indicates the <code>treeitem</code> descendants of the current <code>treeitem</code> widgets are visible e.g. tree sub-leaf is expanded).</li>
                <li>The visual state of being expanded is synchronized with <code>aria-expanded</code> value using CSS attribute selector [<code>aria-expanded=&quot;true&quot;]</code> with the CSS <code>:before</code> psuedo selector and the CSS <code>content</code> property for displaying an image of the expanded state.</li>
              </ul>
            </td>
          </tr>
            <tr>
              <td></td>
              <th scope="row"><code>aria-setsize=&quot;<em>number</em>&quot;</code></th>
              <td><code>li</code>, <code>a</code></td>
              <td>
                <ul>
                  <li><code>aria-setsize</code> is used to indicate the number of <code>treeitem</code>s in the current leaf of the tree.</li>
                  <li>This example relies upon the browser to compute the value of <code>aria-setsize</code>, so it is <strong>not</strong> defined by the author.</li>
                  <li>Browsers are encouraged, but not required to compute the <code>aria-setsize</code> value for a <code>treeitem</code> based on the DOM structure.</li>
                  <li><a href="https://www.w3.org/TR/wai-aria/states_and_properties#aria-setsize">Browser requirements for computing <code>aria-setsize</code> values</a>.</li>
                </ul>
              </td>
            </tr>
            <tr>
              <td></td>
              <th scope="row"><code>aria-posinset=&quot;<em>number</em>&quot;</code></th>
              <td><code>li</code>, <code>a</code></td>
              <td>
                <ul>
                  <li><code>aria-posinset</code> is used to indicate the position of <code>treeitem</code>s in the current leaf of the tree.</li>
                  <li>This example relies upon the browser to compute the value of <code>aria-posinset</code>, so it is <strong>not</strong> defined by the author.</li>
                  <li>Browsers are encouraged, but not required to compute the <code>aria-posinset</code> value for a <code>treeitem</code> based on the DOM structure.</li>
                  <li><a href="https://www.w3.org/TR/wai-aria/states_and_properties#aria-posinset">Browser requirements for computing <code>aria-posinset</code> values</a>.</li>
                </ul>
              </td>
            </tr>
            <tr>
              <td></td>
              <th><code>aria-level=&quot;<em>number</em>&quot;</code></th>
              <td><code>li</code>, <code>a</code></td>
              <td>
                <ul>
                  <li><code>aria-level</code> is used to indicate the depth of <code>treeitem</code>s in the tree structure.</li>
                  <li>This example relies upon the browser to computer the value of <code>aria-level</code>, so it is <strong>not</strong> defined by the author.</li>
                  <li>Browsers are encouraged, but not required to compute the <code>aria-level</code> value for a <code>treeitem</code> based on the DOM structure.</li>
                  <li><a href="https://www.w3.org/TR/wai-aria/states_and_properties#aria-level">Browser requirements for computing <code>aria-level</code> values</a>.</li>
                </ul>
              </td>
            </tr>
            <tr>
              <th scope="row">
                <code>none</code>
              </th>
              <td></td>
              <td>
                <code>li</code>
              </td>
              <td>
                <ul>
                  <li>Hides <code>li</code> element native role semantics of <code>listiem</code> from assistive technologies.</li>
                  <li>If native role semantics of the <code>li</code> element are not removed, it could confuse some users of assistive technologies since listitems and treeitems would be interspersed with each other.</li>
                </ul>
              </td>
            </tr>
          </tbody>
        </table>


      </section>

     <section>
        <h2>Javascript and CSS Source Code</h2>
        <ul>
          <li>
            CSS:
            <a href="css/treeLinks.css" type="text/css">treeLinks.css</a>
          </li>
          <li>
            Javascript:
            <a href="js/treeLinks.js" type="text/javascript">treeLinks.js</a>
          </li>
          <li>
            Javascript:
            <a href="js/treeitemLinks.js" type="text/javascript">treeitemLinks.js</a>
          </li>
          <li>
            Javascript:
            <a href="js/treeitemClick.js" type="text/javascript">treeitemClick.js</a>
          </li>
        </ul>
      </section>

      <section>
        <h2 id="sc1_label">HTML Source Code</h2>
        <div role="separator" id="sc1_start_sep" aria-labelledby="sc1_start_sep sc1_label" aria-label="Start of"></div>
        <div id="sc1"></div>
        <div role="separator" id="sc1_end_sep" aria-labelledby="sc1_end_sep sc1_label" aria-label="End of"></div>

        <script>
          sourceCode.add('sc1', 'ex1');
          sourceCode.make();
        </script>
      </section>
  </main>
  <nav>
    <a href="../../../#TreeView">Tree View Design Pattern in WAI-ARIA Authoring Practices 1.1</a>
  </nav>
  </body>
</html>
