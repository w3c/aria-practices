<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>Listbox Example | WAI-ARIA Authoring Practices 1.1</title>

<!--  Core js and css shared by all examples; do not modify when using this template. -->
<link rel="stylesheet" href="https://www.w3.org/StyleSheets/TR/2016/base.css">
<link rel="stylesheet" href="../css/core.css">
<script src="../js/examples.js"></script>
<script src="../js/highlight.pack.js"></script>
<script src="../js/app.js"></script>
<script src="../js/utils.js" type="text/javascript"></script>

<link href="css/listbox.css" rel="stylesheet">
<script src="js/listbox.js" type="text/javascript"></script>
<script src="js/toolbar.js" type="text/javascript"></script>
<script src="js/main.js" type="text/javascript"></script>
</head>
<body>
  <main>
  <h1>Listbox Example</h1>
  <p>
    This example page is incomplete; it is not ready for review.
    When ready, feedback will be welcome in <a href="https://github.com/w3c/aria-practices/issues/123">issue 123.</a>
  </p>
  <p>
    The following two example implementations of the
    <a href="../../#Listbox">design pattern for listbox</a>
    demonstrate differences between single-select and multi-select functionality.
    In both examples, users can use action buttons to move options from one list to another.
    In the first implementation, users can choose a single option and then activate an action button
while in the second example, they may select multiple options before activating an action button.
  </p>
  <section>
    <h2>Examples</h2>
    <section>
      <h3 id="ex1_label">Example 1: Single-Select Listbox</h3>
      <div role="separator" id="ex1_start_sep" aria-labelledby="ex1_start_sep ex1_label" aria-label="Start of"></div>
      <div id="ex1">
        <p>Rank features important to you when choosing where to live. If a feature is unimportant, move it to the unimportant features list.</p>
        <div class="listbox-area">
          <div class="left-area">
            <span id="ss_imp_l">Important Features:</span>
            <ul id="ss_imp_list" tabindex="0" role="listbox" aria-labelledby="ss_imp_l">
              <li id="ss_opt1" role="option">Proximity of public K-12 schools</li>
              <li id="ss_opt2" role="option">Proximity of child-friendly parks</li>
              <li id="ss_opt3" role="option">Proximity of grocery shopping</li>
              <li id="ss_opt4" role="option">Proximity of fast food</li>
              <li id="ss_opt5" role="option">Proximity of fine dining</li>
              <li id="ss_opt6" role="option">Neighborhood walkability</li>
              <li id="ss_opt7" role="option">Availability of public transit</li>
              <li id="ss_opt8" role="option">Proximity of hospital and medical services</li>
              <li id="ss_opt9" role="option">Level of traffic noise</li>
              <li id="ss_opt10" role="option">Access to major highways</li>
            </ul>
            <div role="toolbar" aria-label="Actions">
              <button id="ex1-up" class="toolbar-item selected" aria-keyshortcuts="Alt+ArrowUp" aria-disabled="true">Up</button>
              <button id="ex1-down" class="toolbar-item" tabindex="-1" aria-keyshortcuts="Alt+ArrowDown" aria-disabled="true">Down</button>
              <button id="ex1-delete" class="toolbar-item move-right-btn" tabindex="-1" aria-keyshortcuts="Alt+ArrowRight Delete" aria-disabled="true">Not Important</button>
            </div>
          </div>
          <div class="right-area">
            <span id="ss_unimp_l">Unimportant Features:</span>
            <ul id="ss_unimp_list" tabindex="0" role="listbox" aria-labelledby="ss_unimp_l" aria-activedescendant="">
            </ul>
            <button id="ex1-add" class="move-left-btn" aria-keyshortcuts="Alt+ArrowLeft Delete" aria-disabled="true">Important</button>
          </div>
        </div>
      </div>
      <div role="separator" id="ex1_end_sep" aria-labelledby="ex1_end_sep ex1_label" aria-label="End of"></div>
      <h4>Notes</h4>
      <ol>
        <li>Assistive technologies are told which option in the list is visually focused by the value of <code>aria-activedescendant</code>:
          <ol>
            <li>DOM focus remains on the <code>listbox</code> element.</li>
            <li>When a key that moves focus is pressed or an option is clicked, JavaScript changes the value of <code>aria-activedescendant</code> on the <code>listbox</code> element.</li>
            <li>If the <code>listbox</code> element does not contain any options, <code>aria-activedescendant</code> does not have a value.</li>
          </ol>
        </li>
        <li>When <kbd>Tab</kbd> moves focus into either listbox:
          <ol>
            <li>If none of the options are selected, the first option receives focus.</li>
            <li>If an option is selected, the selected option receives focus.</li>
          </ol>
        </li>
        <li>Only one option may be selected at a time (have <code>aria-selected=&quot;true&quot;</code>).</li>
        <li>
          As the user moves focus in the list, selection also moves.
          That is, both the value of <code>aria-activedescendant</code> and the element that has <code>aria-selected=&quot;true&quot;</code> change.
        </li>
      </ol>
    </section>

    <section>
      <h3 id="ex2_label">Example 2: Multi-Select Listbox</h3>
      <div role="separator" id="ex2_start_sep" aria-labelledby="ex2_start_sep ex2_label" aria-label="Start of"></div>
      <div id="ex2">
        <p>Choose upgrades for your transport capsule.</p>
        <div class="listbox-area">
          <div class="left-area">
            <span id="ms_av_l">Available upgrades:</span>
            <ul
              id="ms_imp_list"
              tabindex="0"
              role="listbox"
              aria-labelledby="ms_av_l"
              aria-multiselectable="true">
              <li id="ms_opt1" role="option" aria-selected="false">Leather seats</li>
              <li id="ms_opt2" role="option" aria-selected="false">Front seat warmers</li>
              <li id="ms_opt3" role="option" aria-selected="false">Rear bucket seats</li>
              <li id="ms_opt4" role="option" aria-selected="false">Rear seat warmers</li>
              <li id="ms_opt5" role="option" aria-selected="false">Front sun roof</li>
              <li id="ms_opt6" role="option" aria-selected="false">Rear sun roof</li>
              <li id="ms_opt7" role="option" aria-selected="false">Privacy cloque</li>
              <li id="ms_opt8" role="option" aria-selected="false">Food synthesizer</li>
              <li id="ms_opt9" role="option" aria-selected="false">Advanced waste recycling system</li>
              <li id="ms_opt10" role="option" aria-selected="false">Turbo vertical take-off capability</li>
            </ul>
            <button id="ex2-add" class="move-right-btn" aria-keyshortcuts="Alt+ArrowRight Delete" aria-disabled="true">Add</button>
          </div>
          <div class="right-area">
            <span id="ms_ch_l">Upgrades you have chosen:</span>
            <ul
              id="ms_unimp_list"
              tabindex="0"
              role="listbox"
              aria-labelledby="ms_ch_l"
              aria-activedescendant=""
              aria-multiselectable="true">
            </ul>
            <button id="ex2-delete" class="move-left-btn" aria-keyshortcuts="Alt+ArrowLeft Delete" aria-disabled="true">Remove</button>
          </div>
        </div>
      </div>
      <div role="separator" id="ex2_end_sep" aria-labelledby="ex2_end_sep ex2_label" aria-label="End of"></div>
      <h4>Notes</h4>
      <ol>
        <li>Like in example 1, assistive technologies are told which option in the list is visually focused by the value of <code>aria-activedescendant</code>:
          <ol>
            <li>DOM focus remains on the <code>listbox</code> element.</li>
            <li>When a key that moves focus is pressed or an option is clicked, JavaScript changes the value of <code>aria-activedescendant</code> on the <code>listbox</code> element.</li>
            <li>If the <code>listbox</code> element does not contain any options, <code>aria-activedescendant</code> does not have a value.</li>
          </ol>
        </li>
        <li>When <kbd>Tab</kbd> moves focus into either listbox:
          <ol>
            <li>If none of the options are selected, focus is set on the first option.</li>
            <li>If one or more options are selected, focus is set on the first selected option.</li>
          </ol>
        </li>
        <li>Unlike example 1, more than one option may be selected at a time (have <code>aria-selected=&quot;true&quot;</code>).
          <ol>
            <li>The multi-select capability is communicated to assistive technologies by setting <code>aria-multiselectable=&quot;true&quot;</code> on the <code>listbox</code> element.</li>
            <li>All option elements have a value set for <code>aria-selected</code>.</li>
            <li>Selected options have <code>aria-selected</code> set to <code>true</code> and all others have it set to <code>false</code>.</li>
            <li>Keys that move focus do not change the selected state of an option.</li>
          </ol>
        </li>
        <li>Users can toggle the selected state of the focused option with <kbd>Space</kbd> or click.</li>
      </ol>
    </section>

    <section>
      <h3 id="ex3_label">Example 3: Scrollable Listbox</h3>
      <div role="separator" id="ex3_start_sep" aria-labelledby="ex3_start_sep ex3_label" aria-label="Start of"></div>
      <div id="ex3">
        <p>Choose your favorite transuranic element (actinide or transactinide).</p>
        <div class="listbox-area">
          <div class="left-area">
            <span id="ss_elem">Transuranium elements:</span>
            <ul id="ss_elem_list" tabindex="0" role="listbox" aria-labelledby="ss_elem">
              <li id="ss_elem_Np" role="option">Neptunium</li>
              <li id="ss_elem_Pu" role="option">Plutonium</li>
              <li id="ss_elem_Am" role="option">Americium</li>
              <li id="ss_elem_Cm" role="option">Curium</li>
              <li id="ss_elem_Bk" role="option">Berkelium</li>
              <li id="ss_elem_Cf" role="option">Californium</li>
              <li id="ss_elem_Es" role="option">Einsteinium</li>
              <li id="ss_elem_Fm" role="option">Fermium</li>
              <li id="ss_elem_Md" role="option">Mendelevium</li>
              <li id="ss_elem_No" role="option">Nobelium</li>
              <li id="ss_elem_Lr" role="option">Lawrencium</li>
              <li id="ss_elem_Rf" role="option">Rutherfordium</li>
              <li id="ss_elem_Db" role="option">Dubnium</li>
              <li id="ss_elem_Sg" role="option">Seaborgium</li>
              <li id="ss_elem_Bh" role="option">Bohrium</li>
              <li id="ss_elem_Hs" role="option">Hassium</li>
              <li id="ss_elem_Mt" role="option">Meitnerium</li>
              <li id="ss_elem_Ds" role="option">Darmstadtium</li>
              <li id="ss_elem_Rg" role="option">Roentgenium</li>
              <li id="ss_elem_Cn" role="option">Copernicium</li>
              <li id="ss_elem_Nh" role="option">Nihonium</li>
              <li id="ss_elem_Fl" role="option">Flerovium</li>
              <li id="ss_elem_Mc" role="option">Moscovium</li>
              <li id="ss_elem_Lv" role="option">Livermorium</li>
              <li id="ss_elem_Ts" role="option">Tennessine</li>
              <li id="ss_elem_Og" role="option">Oganesson</li>
            </ul>
          </div>
        </div>
      </div>
      <div role="separator" id="ex3_end_sep" aria-labelledby="ex3_end_sep ex3_label" aria-label="End of"></div>
      <h4>Notes</h4>
      <ol>
        <li>This example has a <code>listbox</code> with more options than its height can accommodate.</li>
        <li>Scrolling only works as expected if the listbox is the options' <code>offsetParent</code>.
          The example uses <code>position: relative</code> on the listbox to that effect.</li>
        <li>When an option is focused that isn't (fully) visible, the listbox's scroll position is updated:
          <ol>
            <li>If <kbd>Up Arrow</kbd> or <kbd>Down Arrow</kbd> is pressed, the previous or next option is scrolled into view.</li>
            <li>If <kbd>Home</kbd> or <kbd>End</kbd> is pressed, the listbox scrolls all the way to the top or to the bottom.</li>
            <li>If <code>focusItem</code> is called, the focused option will be scrolled to the top of the view if it was located above it or to the bottom if it was below it.</li>
            <li>If the mouse is clicked on a partially visible option, it will be scrolled fully into view.</li>
          </ol>
        </li>
        <li>When a fully visible option is focused in any way, no scrolling occurs.</li>
        <li>Normal scrolling through any scrolling mechanism (including <kbd>Page Up</kbd> and <kbd>Page Down</kbd>) works as expected.
          The scroll position will jump as described for <code>focusItem</code> if another means than a mouse click is used to change focus after scrolling.</li>
        <li>This example uses a single-select listbox, but works just as well with a multi-select listbox.</li>
      </ol>
    </section>
  </section>

  <section>
    <h2>Other Accessibility Features</h2>
    <ol>
      <li>Keyboard shortcuts for action buttons:
        <ol>
          <li>Action buttons have the following shortcuts:
            <ul>
              <li>&quot;Up&quot;: <kbd>Alt + Up Arrow</kbd></li>
              <li>&quot;Down&quot;: <kbd>Alt + Down Arrow</kbd></li>
              <li>&quot;Add&quot;: <kbd>Enter</kbd></li>
              <li>&quot;Not Important&quot;, &quot;Important&quot;, and &quot;Remove&quot;: <kbd>Delete</kbd></li>
            </ul>
          </li>
          <li>Availability of the shortcuts is communicated to assistive technologies via the <code>aria-keyshortcuts</code> property on the button elements.</li>
          <li>Each shortcut is only captured when focus is in a context where it is relevant.
            For example, <kbd>Enter</kbd> performs an add only when focus is in the available options list,
            and <kbd>Delete</kbd> performs a remove only when focus is in the chosen options list.
          </li>
          <li>
            Using a shortcut key intentionally places focus to optimize both screen reader and keyboard usability.
            For example, pressing <kbd>Alt + Up Arrow</kbd> in the &quot;Important Features&quot; list keeps focus on the option that is moved up,
            enabling all keyboard users to easily perform consecutive move operations for an option
            and screen reader users to hear the position of an option after it is moved.
            Similarly, pressing <kbd>Enter</kbd> in the available options list leaves focus in the available options list.
            If the option that had focus before the add operation is no longer present in the list, focus lands on the first of the subsequent options that is still present.
          </li>
        </ol>
      </li>
      <li>In example 1, since there are four action buttons, a toolbar widget is used to group all the action buttons into a single tab stop.</li>
    </ol>
  </section>

  <section>
    <h2 id="kbd_label">Keyboard Support</h2>
    <ul>
      <li>
        <kbd>Down Arrow</kbd>: Moves focus to the next option.
      </li>
      <li>
        <kbd>Up Arrow</kbd>: Moves focus to the previous option.
      </li>
      <li>
        <kbd>Home</kbd>: Moves focus to first option.
      </li>
      <li>
        <kbd>End</kbd>: Moves focus to last option.
      </li>
    </ul>
    <p>Multiple selection keys supported in example 2:</p>
    <ul>
      <li>
        <kbd>Space</kbd>: changes the selection state of the focused option .
      </li>
      <li>
        <kbd>Shift + Down Arrow</kbd>: Moves focus to and selects the next option.
      </li>
      <li>
        <kbd>Shift + Up Arrow</kbd>: Moves focus to and selects the previous option.
      </li>
      <li>
        <kbd>Control + Shift + Home</kbd>: Selects from the focused option to the beginning of the list.
      </li>
      <li>
        <kbd>Control + Shift + End</kbd>: Selects from the focused option to the end of the list.
      </li>
      <li>
        <kbd>Control + A</kbd>: selects all options in the list.
        If all options are selected, unselects all options.
      </li>
    </ul>
  </section>

  <section>
    <h2 id="rps_label">Role, Property, State, and Tabindex  Attributes</h2>
    <table aria-labelledby="rps_label" class="data attributes">
      <thead>
        <tr>
          <th>Attribute</th>
          <th>Applied to Element</th>
          <th>Usage</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th><code>role=&quot;listbox&quot;</code></th>
          <td><code>ul</code></td>
          <td>Identifies the focusable element that has listbox behaviors and contains the listbox options. </td>
        </tr>
        <tr>
          <th><code>aria-labelledby=&quot;ID_REF&quot;</code></th>
          <td><code>ul</code></td>
          <td>Applied to the element with the listbox role, it refers to the span containing its label.</td>
        </tr>
        <tr>
          <th><code>tabindex=&quot;0&quot;</code></th>
          <td><code>ul</code></td>
          <td>Applied to the element with the listbox role, it puts the listbox in the tab sequence.</td>
        </tr>
        <tr>
          <th><code>aria-multiselectable=&quot;true&quot;</code></th>
          <td><code>ul</code></td>
          <td>
            <strong>Example 2 only:</strong>
            Applied to the element with the listbox role, tells assistive technologies that the list supports multiple selection.
            The default value is false so it is not specified in example 1.
          </td>
        </tr>
        <tr>
          <th><code>aria-activedescendant=&quot;ID_REF&quot;</code></th>
          <td><code>ul</code></td>
          <td>
            Applied to the element with the listbox role, tells assistive technologies which of the options, if any, is visually indicated as having keyboard focus.
            DOM focus remains on the <code>ul</code> element and the idref specified for <code>aria-activedescendant</code> refers to the <code>li</code> element that is visually styled as focused.
            When navigation keys, such as <kbd>Down Arrow</kbd>, are pressed, the JavaScript changes the value.
            When the listbox is empty, <code>aria-activedescendant=&quot;&quot;</code>.
          </td>
        </tr>
        <tr>
          <th><code>role=&quot;option&quot;</code></th>
          <td><code>li</code></td>
          <td>Identifies each selectable element containing the name of an option.</td>
        </tr>
        <tr>
          <th><code>aria-selected=&quot;true&quot;</code></th>
          <td><code>li</code></td>
          <td>
            Applied to elements with role option that are visually styled as  selected to inform assistive technologies that the options are selected.
            In example 1, this is always the same option that is referenced by aria-activedescendant because it is a single-select listbox where selection follows focus.
            In example 2, more than one option may be selected so the user can move focus among options without effecting which options are selected.
            Thus in example 2, the focus style and selection styles are distinctly different and independent.
          </td>
        </tr>
        <tr>
          <th><code>aria-selected=&quot;false&quot;</code></th>
          <td><code>li</code></td>
          <td>
            <strong>Example 2 only:</strong>
            Applied to elements with role option that are <strong>not</strong> visually styled as  selected to inform assistive technologies that the options are selectable but not selected.
            In example 1, this is not necessary because the focus cannot move to an unselected option.
          </td>
        </tr>
      </tbody>
    </table>
    <p>The following attributes are commonly useful when implementing the listbox design pattern but are not used in these examples.</p>
    <ul>
      <li><code>aria-setsize</code> and <code>aria-posinset</code>: Since all option elements are present in the DOM, the browser is able to calculate these values automatically and provide them to assistive technologies.</li>
      <li><code>aria-orientation</code>: The default orientation for a listbox is vertical so it is not necessary to specify a value.</li>
    </ul>
  </section>

  <section>
    <h2>Javascript and CSS Source Code</h2>
    <ul>
      <li>
        CSS:
        <a href="css/listbox.css" type="tex/css">listbox.css</a>
      </li>
      <li>
        Javascript:
        <a href="js/listbox.js" type="text/javascript">listbox.js</a>
      </li>
    </ul>
  </section>

  <section>
    <h2>HTML Source Code</h2>
    <h3 id="sc1_label">Example 1: Single-Select Listbox</h3>
    <div id="sc1_start_sep" role="separator" aria-labelledby="sc1_start_sep sc1_label" aria-label="Start of HTML for"></div>
    <pre><code id="sc1"></code></pre>
    <div id="sc1_end_sep" role="separator" aria-labelledby="sc1_end_sep sc1_label" aria-label="End of HTML for"></div>
    <script>sourceCode.add('sc1', 'ex1')</script>
    <h3 id="sc2_label">Example 2: Multi-Select Listbox</h3>
    <div id="sc2_start_sep" role="separator" aria-labelledby="sc2_start_sep sc2_label" aria-label="Start of HTML for"></div>
    <pre><code id="sc2"></code></pre>
    <div id="sc2_end_sep" role="separator" aria-labelledby="sc2_end_sep sc2_label" aria-label="End of HTML for"></div>
    <script>sourceCode.add('sc2', 'ex2')</script>
    <h3 id="sc3_label">Example 3: Scrollable Listbox</h3>
    <div id="sc3_start_sep" role="separator" aria-labelledby="sc3_start_sep sc3_label" aria-label="Start of HTML for"></div>
    <pre><code id="sc3"></code></pre>
    <div id="sc3_end_sep" role="separator" aria-labelledby="sc3_end_sep sc3_label" aria-label="End of HTML for"></div>
    <script>sourceCode.add('sc3', 'ex3')</script>
    <!--  After all source has been added, run make to do the insert.  -->
    <script> sourceCode.make() </script>
  </section>
  </main>
  <nav>
    <a href="../../#Listbox">Listbox Design Pattern in WAI-ARIA Authoring Practices 1.1</a>
  </nav>
</body>
</html>
