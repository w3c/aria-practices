<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Experimental Example of Scrollable Listbox with Actions on Options</title>

    <!-- Core JS and CSS shared by all examples -->
    <link rel="stylesheet" href="https://www.w3.org/StyleSheets/TR/2016/base.css">
    <link rel="stylesheet" href="../../../shared/css/core.css">
    <script src="../../../shared/js/examples.js"></script>
    <script src="../../../shared/js/highlight.pack.js"></script>
    <script src="../../../shared/js/app.js"></script>
    <script data-skipto="colorTheme:aria; displayOption:popup; containerElement:div" src="../../../shared/js/skipto.js"></script>

    <!-- JS and CSS for this example -->
    <link href="css/listbox.css" rel="stylesheet">
    <script src="js/listbox.js"></script>
    <script src="js/listbox-scrollable.js"></script>
  </head>
  <body>
    <nav aria-label="Related Links" class="feedback">
      <ul>
        <li><a href="https://github.com/orgs/w3c/projects/131">Related Issues</a></li>
        <li><a href="../listbox-pattern.html">Design Pattern</a></li>
      </ul>
    </nav>
    <main data-content-phase="experimental">
      <h1>Experimental Example of Scrollable Listbox with Actions on Options</h1>

      <section>
        <h2>About This Experimental Example</h2>
        <img alt="" class="example-page-example-icon" src="../../../images/pattern-listbox.svg">
        <p>
          This is an experimental implementation of the <a href="https://pr-preview.s3.amazonaws.com/w3c/aria/pull/1805.html#aria-actions">draft specification of the aria-actions attribute</a>.
          The <code>aria-actions</code> property enables an element to reference one or more interactive elements that can be activated to perform an action on the referencing element.
          In this example, each <code>option</code> element in the <code>listbox</code> references several buttons that perform actions on the <code>option</code>.
          The relationship provided by <code>aria-actions</code> enables an assistive technology to both communicate the  availability of the action button and provide a command for activating the button while focus is on the tab.
        </p>
        <p>
          The following example implementation of the <a href="../listbox-pattern.html">Listbox Pattern</a> demonstrates a scrollable single-select listbox widget.
          This widget is functionally similar to an HTML <code>select</code> input where the <code>size</code> attribute has a value greater than one.
        </p>
        <p>
          This example also demonstrates how to provide buttons that provide contextual actions for each item in the list.
          Each <code>option</code> has an associated set of four actions that enable users to move an option up or down, favorite it, or remove it from the list.
          The contextual actions are provided by buttons that appear on hover or focus.
          The buttons are referenced by <code>aria-actions</code> specified on the <code>option</code> element, which enables them to be discovered and activated by an assistive technology user while focus is on the <code>option</code>.
        </p>
        <p>Similar examples include:</p>
        <ul>
          <li><a href="listbox-scrollable.html">Scrollable Listbox Example</a>: Single-select listbox that scrolls to reveal more options, similar to HTML <code>select</code> with <code>size</code> attribute greater than one.</li>
          <li><a href="listbox-rearrangeable.html">Example Listboxes with Rearrangeable Options</a>: Examples of both single-select and multi-select listboxes with accompanying toolbars where options can be added, moved, and removed.</li>
          <li><a href="listbox-grouped.html">Listbox Example with Grouped Options</a>: Single-select listbox with grouped options, similar to an HTML <code>select</code> with <code>optgroup</code> children.</li>
        </ul>
      </section>

      <section>
        <div class="example-header">
          <h2 id="ex_label">Example</h2>
        </div>
        <div role="separator" id="ex_start_sep" aria-labelledby="ex_start_sep ex_label" aria-label="Start of"></div>
        <div id="ex">
          <p>Choose your favorite transuranic element (actinide or transactinide).</p>
          <div class="listbox-area">
            <div>
              <span id="ss_elem" class="listbox-label">Transuranium elements:</span>
              <ul id="ss_elem_list" tabindex="0" role="listbox" aria-labelledby="ss_elem">
                <li id="ss_elem_None" role="option">
                  <span class="checkmark" aria-hidden="true"></span>
                  None
                </li>
                <li id="ss_elem_Np" role="option">
                  <span class="checkmark" aria-hidden="true"></span>
                  Neptunium
                </li>
                <li id="ss_elem_Pu" role="option">
                  <span class="checkmark" aria-hidden="true"></span>
                  Plutonium
                </li>
                <li id="ss_elem_Am" role="option">
                  <span class="checkmark" aria-hidden="true"></span>
                  Americium
                </li>
                <li id="ss_elem_Cm" role="option">
                  <span class="checkmark" aria-hidden="true"></span>
                  Curium
                </li>
                <li id="ss_elem_Bk" role="option">
                  <span class="checkmark" aria-hidden="true"></span>
                  Berkelium
                </li>
                <li id="ss_elem_Cf" role="option">
                  <span class="checkmark" aria-hidden="true"></span>
                  Californium
                </li>
                <li id="ss_elem_Es" role="option">
                  <span class="checkmark" aria-hidden="true"></span>
                  Einsteinium
                </li>
                <li id="ss_elem_Fm" role="option">
                  <span class="checkmark" aria-hidden="true"></span>
                  Fermium
                </li>
                <li id="ss_elem_Md" role="option">
                  <span class="checkmark" aria-hidden="true"></span>
                  Mendelevium
                </li>
                <li id="ss_elem_No" role="option">
                  <span class="checkmark" aria-hidden="true"></span>
                  Nobelium
                </li>
                <li id="ss_elem_Lr" role="option">
                  <span class="checkmark" aria-hidden="true"></span>
                  Lawrencium
                </li>
                <li id="ss_elem_Rf" role="option">
                  <span class="checkmark" aria-hidden="true"></span>
                  Rutherfordium
                </li>
                <li id="ss_elem_Db" role="option">
                  <span class="checkmark" aria-hidden="true"></span>
                  Dubnium
                </li>
                <li id="ss_elem_Sg" role="option">
                  <span class="checkmark" aria-hidden="true"></span>
                  Seaborgium
                </li>
                <li id="ss_elem_Bh" role="option">
                  <span class="checkmark" aria-hidden="true"></span>
                  Bohrium
                </li>
                <li id="ss_elem_Hs" role="option">
                  <span class="checkmark" aria-hidden="true"></span>
                  Hassium
                </li>
                <li id="ss_elem_Mt" role="option">
                  <span class="checkmark" aria-hidden="true"></span>
                  Meitnerium
                </li>
                <li id="ss_elem_Ds" role="option">
                  <span class="checkmark" aria-hidden="true"></span>
                  Darmstadtium
                </li>
                <li id="ss_elem_Rg" role="option">
                  <span class="checkmark" aria-hidden="true"></span>
                  Roentgenium
                </li>
                <li id="ss_elem_Cn" role="option">
                  <span class="checkmark" aria-hidden="true"></span>
                  Copernicium
                </li>
                <li id="ss_elem_Nh" role="option">
                  <span class="checkmark" aria-hidden="true"></span>
                  Nihonium
                </li>
                <li id="ss_elem_Fl" role="option">
                  <span class="checkmark" aria-hidden="true"></span>
                  Flerovium
                </li>
                <li id="ss_elem_Mc" role="option">
                  <span class="checkmark" aria-hidden="true"></span>
                  Moscovium
                </li>
                <li id="ss_elem_Lv" role="option">
                  <span class="checkmark" aria-hidden="true"></span>
                  Livermorium
                </li>
                <li id="ss_elem_Ts" role="option">
                  <span class="checkmark" aria-hidden="true"></span>
                  Tennessine
                </li>
                <li id="ss_elem_Og" role="option">
                  <span class="checkmark" aria-hidden="true"></span>
                  Oganesson
                </li>
              </ul>
            </div>
          </div>
        </div>
        <div role="separator" id="ex_end_sep" aria-labelledby="ex_end_sep ex_label" aria-label="End of"></div>
      </section>

      <section  id="accessibility_features">
        <h2>Accessibility Features</h2>
        <ul>
          <li>
            Because this listbox implementation is scrollable and manages which option is focused by <a href="../../../practices/keyboard-interface/keyboard-interface-practice.html#kbd_focus_activedescendant">using aria-activedescendant</a>, the JavaScript must ensure the focused option is visible.
            So, when a keyboard or pointer event changes the option referenced by <code>aria-activedescendant</code>, if the referenced option is not fully visible, the JavaScript scrolls the listbox to position the option in view.
          </li>
          <li>
            To enhance perceivability when operating the listbox, visual keyboard focus and hover are styled using the CSS <code>:hover</code> and <code>:focus</code> pseudo-classes:
            <ul>
              <li>To help people with visual impairments identify the listbox as an interactive element, the cursor is changed to a pointer when hovering over the list.</li>
              <li>To make it easier to distinguish the selected listbox option from other options, selection creates a 2 pixel border above and below the option.</li>
            </ul>
          </li>
        </ul>
      </section>

      <section>
        <h2 id="kbd_label">Keyboard Support</h2>
        <p>
          The example listbox on this page implements the following keyboard interface.
          Other variations and options for the keyboard interface are described in the <a href="../listbox-pattern.html#keyboard_interaction">Keyboard Interaction section of the Listbox Pattern</a>.
        </p>
        <p>
          <strong>NOTE:</strong> When visual focus is on an option in this listbox implementation, DOM focus remains on the listbox element and the value of <code>aria-activedescendant</code> on the listbox refers to the descendant option that is visually indicated as focused.
          Where the following descriptions of keyboard commands mention focus, they are referring to the visual focus indicator, not DOM focus.
          For more information about this focus management technique, see
          <a href="../../../practices/keyboard-interface/keyboard-interface-practice.html#kbd_focus_activedescendant">Managing Focus in Composites Using aria-activedescendant</a>.
        </p>
        <table aria-labelledby="kbd_label" class="def">
          <thead>
            <tr>
              <th>Key</th>
              <th>Function</th>
            </tr>
          </thead>
          <tbody>
            <tr data-test-id="key-tab">
              <th><kbd>Tab</kbd></th>
              <td>Moves focus into and out of the listbox.</td>
            </tr>
            <tr data-test-id="key-down-arrow">
              <th><kbd>Down Arrow</kbd></th>
              <td>Moves focus to and selects the next option.</td>
            </tr>
            <tr data-test-id="key-up-arrow">
              <th><kbd>Up Arrow</kbd></th>
              <td>Moves focus to and selects the previous option.</td>
            </tr>
            <tr data-test-id="key-right-arrow">
              <th><kbd>Right Arrow</kbd></th>
              <td>
                <ul>
                  <li>If an option has focus, moves focus to the first action button.</li>
                  <li>If an action button has focus, moves focus to the next action button for the current option.</li>
                  <li>If the last action button has focus, does nothing.</li>
                </ul>
              </td>
            </tr>
            <tr data-test-id="key-left-arrow">
              <th><kbd>Left Arrow</kbd></th>
              <td>
                <ul>
                  <li>If any action button except for the first action button has focus, moves focus to the previous action button for the current option.</li>
                  <li>If the first action button has focus, moves focus to the current option.</li>
                  <li>If an option has focus, does nothing.</li>
                </ul>
              </td>
            </tr>
            <tr data-test-id="key-home">
              <th><kbd>Home</kbd></th>
              <td>Moves focus to and selects the first option.</td>
            </tr>
            <tr data-test-id="key-end">
              <th><kbd>End</kbd></th>
              <td>Moves focus to and selects the last option.</td>
            </tr>
            <tr data-test-id="key-character">
              <th>Printable Characters</th>
              <td>
                <ul>
                  <li>Type a character: focus moves to the next item with a name that starts with the typed character.</li>
                  <li>Type multiple characters in rapid succession: focus moves to the next item with a name that starts with the string of characters typed.</li>
                </ul>
              </td>
            </tr>
          </tbody>
        </table>
      </section>

      <section>
        <h2 id="rps_label">Role, Property, State, and Tabindex Attributes</h2>
        <p>
          The example listbox on this page implements the following ARIA roles, states, and properties.
          Information about other ways of applying ARIA roles, states, and properties is available in the <a href="../listbox-pattern.html#roles_states_properties">Roles, States, and Properties section of the Listbox Pattern</a>.
        </p>
        <table aria-labelledby="rps_label" class="data attributes">
          <thead>
            <tr>
              <th scope="col">Role</th>
              <th scope="col">Attribute</th>
              <th scope="col">Element</th>
              <th scope="col">Usage</th>
            </tr>
          </thead>
          <tbody>
            <tr data-test-id="listbox-role">
              <th scope="row"><code>listbox</code></th>
              <td></td>
              <td><code>ul</code></td>
              <td>Identifies the focusable element that has listbox behaviors and contains the listbox options.</td>
            </tr>
            <tr data-test-id="listbox-aria-labelledby">
              <td></td>
              <th scope="row"><code>aria-labelledby="ID_REF"</code></th>
              <td><code>ul</code></td>
              <td>Refers to the element containing the listbox label.</td>
            </tr>
            <tr data-test-id="listbox-tabindex">
              <td></td>
              <th scope="row"><code>tabindex="0"</code></th>
              <td><code>ul</code></td>
              <td>Includes the listbox in the page tab sequence.</td>
            </tr>
            <tr data-test-id="listbox-aria-activedescendant">
              <td></td>
              <th scope="row"><code>aria-activedescendant="ID_REF"</code></th>
              <td><code>ul</code></td>
              <td>
                <ul>
                  <li>When an option in the listbox is visually indicated as having keyboard focus, refers to that option.</li>
                  <li>Enables assistive technologies to know which element the application regards as focused while DOM focus remains on the listbox element.</li>
                  <li>When navigation keys, such as <kbd>Down Arrow</kbd>, are pressed, the JavaScript changes the value.</li>
                  <li>
                    For more information about this focus management technique, see
                    <a href="../../../practices/keyboard-interface/keyboard-interface-practice.html#kbd_focus_activedescendant">Managing Focus in Composites Using aria-activedescendant</a>.
                  </li>
                </ul>
              </td>
            </tr>
            <tr data-test-id="option-role">
              <th scope="row"><code>option</code></th>
              <td></td>
              <td><code>li</code></td>
              <td>Identifies each selectable element containing the name of an option.</td>
            </tr>
            <tr data-test-id="option-aria-selected">
              <td></td>
              <th scope="row"><code>aria-selected="true"</code></th>
              <td><code>li</code></td>
              <td>
                <ul>
                  <li>Indicates that the option is selected.</li>
                  <li>Applied to the element with role option that is visually styled as selected.</li>
                  <li>The option with this attribute is always the same as the option that is referenced by aria-activedescendant because it is a single-select listbox where selection follows focus.</li>
                </ul>
              </td>
            </tr>
            <tr data-test-id="option-aria-actions-empty">
              <td></td>
              <th scope="row"><code>aria-actions=""</code></th>
              <td><code>li</code></td>
              <td>
                <ul>
                  <li>Indicates to assistive technologies that the option will have actions available on focus or hover, enabling the assistive technology to focus the element to gain access to the actions.</li>
                  <li>Applied to all elements with role option when they are not visually styled as selected and are not referenced by <code>aria-activedescendant</code>.</li>
                </ul>
              </td>
            </tr>
            <tr data-test-id="option-aria-actions-refs">
              <td></td>
              <th scope="row"><code>aria-actions="ID_REFS"</code></th>
              <td><code>li</code></td>
              <td>
                <ul>
                  <li>Specifies the ID attributes of the action buttons that are associated with the option.</li>
                  <li>Applied to the element with role option that is visually styled as selected and is referenced by <code>aria-activedescendant</code>.</li>
                </ul>
              </td>
            </tr>
            <tr data-test-id="span-aria-hidden">
              <td></td>
              <th><code>aria-hidden="true"</code></th>
              <td><code>span</code></td>
              <td>
                Removes the character entity used for the check mark icon from the accessibility tree to prevent it from being included in the accessible name of the option.
              </td>
            </tr>
          </tbody>
        </table>
      </section>

      <section>
        <h2>JavaScript and CSS Source Code</h2>
        <ul id="css_js_files">
          <li>
            CSS:
            <a href="css/listbox.css" type="tex/css">listbox.css</a>
          </li>
          <li>
            JavaScript:
            <a href="js/listbox.js" type="text/javascript">listbox.js</a>, <a href="js/listbox-scrollable.js" type="text/javascript">listbox-scrollable.js</a>
          </li>
        </ul>
      </section>

      <section class="example-code">
        <h2 id="sc_label">HTML Source Code</h2>
        <p id="sc1_description">To copy the following HTML code, please open it in CodePen.</p>
        <div id="sc_start_sep" role="separator" aria-labelledby="sc_start_sep sc_label" aria-label="Start of "></div>
        <pre><code id="sc1"></code></pre>
        <div id="sc_end_sep" role="separator" aria-labelledby="sc_end_sep sc_label" aria-label="End of"></div>
        <script>
          sourceCode.add('sc1', 'ex', 'ex_label', 'css_js_files', 'sc1_description');
          sourceCode.make();
        </script>
      </section>
    </main>
  </body>
</html>
